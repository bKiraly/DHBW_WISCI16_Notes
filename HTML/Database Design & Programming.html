<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Database Design &amp; -Programming</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="database-design---programming">Database Design &amp; -Programming</h1>
<blockquote>
<p><strong>Disclaimer</strong><br>
These are notes created for my personal use. They mostly cover the contents of the lectures. I take no responsibility for the correctness of anything stated in the contents, although I strive for making them as accurate as possible. If you find any factual or formal mistakes in these notes, please don’t hesitate to contact me at <a href="mailto:kiraly.bence.1025@gmail.com">kiraly.bence.1025@gmail.com</a>.</p>
</blockquote>
<h2 id="introduction">Introduction</h2>
<p>Recommended book: Information Modeling and Relational Databases by Terry Halpin<br>
Relational databases - Based on Set theory<br>
Hierarchical databases<br>
Blockchain<br>
NoSQL</p>
<p>A database is the backend of every computing system.<br>
Persistent data storage for large amounts of data with simple access points<br>
Data is much harder to recreate than hardware or software<br>
Database applications are the ‘active’ part of DB systems</p>
<p>History of database systems:</p>
<ul>
<li>File system
<ul>
<li>Limited linkage and integrity management</li>
<li>Limited access control</li>
</ul>
</li>
<li>Excel files
<ul>
<li>Better linkage and integrity</li>
<li>Problems with data inconsistency</li>
<li>Security concerns</li>
<li>No centralized mechanism to replicate data across multiple systems</li>
</ul>
</li>
<li>Relational Databases
<ul>
<li>Database language
<ul>
<li>Structured Query Language (SQL)</li>
<li>De-facto standard</li>
<li>Different dialects</li>
</ul>
</li>
<li>DBMS
<ul>
<li>Database management system</li>
<li>Logically accesses data</li>
<li>Different from the database itself</li>
<li>Companies are different</li>
<li>Different SQL dialects</li>
</ul>
</li>
<li>Database structure
<ul>
<li>Responsibility of the database architect</li>
<li>Logical structure</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Roles of database users</p>
<ul>
<li>Database administration
<ul>
<li>Installation, configuration, maintenance, upgrade</li>
<li>Administration</li>
<li>Monitoring and optimization</li>
<li>Backup and restore</li>
</ul>
</li>
<li>Database architect
<ul>
<li>Design and optimize databases</li>
<li>Structures data logically</li>
</ul>
</li>
<li>Application developer
<ul>
<li>Implements business process based on data from database</li>
</ul>
</li>
</ul>
<p>Relational database systems</p>
<ul>
<li>Commercial
<ul>
<li>DB2 (IBM)</li>
<li>Oracle DB (Oracle)</li>
<li>SQL Server / Access (Microsoft)</li>
<li>SQL Anywhere / Adaptive Server (Sybase)</li>
<li>SAP MaxDB (SAP)</li>
</ul>
</li>
<li>Open-source
<ul>
<li>MySQL (Oracle)</li>
<li>Ingres (Actian)</li>
<li>PostgreSQL</li>
<li>MariaDB</li>
</ul>
</li>
</ul>
<p>Features of a DBMS</p>
<ul>
<li>Consistent data storage / integrity</li>
<li>Multi-user access</li>
<li>Backup</li>
<li>High-availability</li>
<li>Consistency</li>
<li>Isolation</li>
<li>Access permission control</li>
<li>Authentication</li>
</ul>
<h2 id="database-design">Database Design</h2>
<h3 id="overview">Overview</h3>
<ul>
<li>Conceptual design // E/R Modelling</li>
<li>Logical design // Transformation into tables</li>
<li>Normalization // Remove redundancies</li>
<li>Physical design // SQL</li>
</ul>
<h3 id="conceptual-design">Conceptual Design</h3>
<p>ACID properties</p>
<ul>
<li>Atomicity
<ul>
<li>A transaction is either executed completely, or not at all</li>
</ul>
</li>
<li>Consistency
<ul>
<li>Integrity constraints are not violated</li>
</ul>
</li>
<li>Isolation
<ul>
<li>Separate systems are running as though they were the only instance</li>
</ul>
</li>
<li>Durability
<ul>
<li>The results are persistent</li>
</ul>
</li>
</ul>
<p>CAP</p>
<ul>
<li>Consistency
<ul>
<li>All systems have the same state of data</li>
</ul>
</li>
<li>Availability
<ul>
<li>Queries against the systems are always answered</li>
</ul>
</li>
<li>Partition tolerance
<ul>
<li>The system continues, even if parts are unavailable</li>
</ul>
</li>
</ul>
<p>Theory says that a system might fulfill at most two of them</p>
<ul>
<li>A and P
<ul>
<li>DNS system</li>
<li>Most web services</li>
</ul>
</li>
<li>C and A
<ul>
<li>Enterprise DB systems</li>
<li>Classical DB systems</li>
</ul>
</li>
<li>C and P
<ul>
<li>ATMs</li>
<li>Blockchain</li>
</ul>
</li>
</ul>
<p>Requirement engineering (Lots of interviews with the customer)</p>
<p>Procedure</p>
<ul>
<li>Reality</li>
<li>Identification of subdomain</li>
<li>Conceptual data model</li>
<li>Logical data model</li>
<li>Physical data model</li>
</ul>
<p><em>Skip, skip</em></p>
<h3 id="logical-design">Logical Design</h3>
<p>Requirements</p>
<ul>
<li>Customer Requirements</li>
<li>Written Documentation of the requirements</li>
<li>Graphical representation</li>
<li>Database
<ul>
<li>Weak entities</li>
<li>Not needed for business process</li>
<li>Is just an implementation artifact</li>
<li>Structured Attributes (Attributes that consist of multiple other (atomic) attributes)</li>
<li>Redundancy -&gt; Normal forms</li>
<li>Relationships are expressed with a verb</li>
<li>The relation itself may be an entity</li>
<li>BPMN - Business Process Modeling Notation</li>
</ul>
</li>
</ul>
<h3 id="physical-design">Physical Design</h3>
<p>Normal forms</p>
<h4 id="keys">Keys</h4>
<h5 id="primary-key">Primary Key</h5>
<p>Primary key - Unique identifier of the given element e.g. the ID of a user<br>
Surrogate primary key - A primary key consisting of multiple attributes (e.g. first name and last name)</p>
<h5 id="foreign-key">Foreign key</h5>
<p>The primary keys of other tables, used in relations</p>
<h4 id="attributes">Attributes</h4>
<h5 id="complex-attributes">Complex attributes</h5>
<p>These attributes can be broken down to different sub-attributes (e.g. Name of a person -&gt; First name, Last name)</p>
<h5 id="atomic-attributes">Atomic attributes</h5>
<p>These attributes can not be logically split any further (e.g. First name of a person)</p>
<h5 id="null">NULL</h5>
<p>The value <code>NULL</code> is used when the value of the attribute is not known. It can only be used if the attribute is <strong>optional</strong>, that is it is not <strong>mandatory</strong> to fill in the field. It represents <em>no data</em> for the entity, and is thus different from the empty string <code>""</code> and <code>0</code>.</p>
<h4 id="referential-integrity">Referential integrity</h4>
<p>Entities on both sides of the relation must exist according to the rules of the database design</p>
<h4 id="relationships">Relationships</h4>
<ul>
<li>[1…1]
<ul>
<li>Simple</li>
<li>The one entity should have a foreign key to another</li>
</ul>
</li>
<li>[1…n]
<ul>
<li>The attribute that there are many of includes the a foreign key for the other attribute</li>
</ul>
</li>
<li>[n…m]
<ul>
<li>There is an associative table, additional attributes can also be added</li>
</ul>
</li>
<li>Recursive relationship
<ul>
<li>The entity has a field for another foreign key to the primary key of its own table.</li>
</ul>
</li>
<li>Dependency relationship
<ul>
<li>A depends on B</li>
<li>Primary Key, Foreign key concept (incomplete)</li>
<li>Associative table -&gt; complete</li>
</ul>
</li>
</ul>
<h3 id="normal-forms">Normal Forms</h3>
<h4 id="normal-form">1. Normal form</h4>
<p>Attributes must be atomic</p>
<h4 id="normal-form-1">2. Normal form</h4>
<p>Attributes must be <em>functionally dependent</em> from the primary key</p>
<h4 id="normal-form-2">3. Normal form</h4>
<p>Attributes must be <em>directly</em> dependent on the primary key</p>
<h4 id="boyce-codd-normal-form">Boyce-Codd Normal form</h4>
<p>There must not be any <em>functional dependency</em> between different attributes</p>
<h3 id="parts-of-a-database-package">Parts of a database package</h3>
<ul>
<li>DB Engine</li>
<li>DB Design (eg. MySQL Workbench)</li>
<li>CLI (eg. mysql)</li>
<li>Programming Interface / Connectivity (eg. JDBC)</li>
<li>Maintaining / Administration (eg. phpMyAdmin)</li>
<li>Development tools (eg. Eclipse, PHP, Python, Notepad++, APEX, PowerBuilder)</li>
</ul>
<h2 id="database-programming">Database Programming</h2>
<h3 id="sql">SQL</h3>
<ul>
<li>Standardization: ISO 9075:yyyy</li>
<li>Standard not completely observed by DB vendors</li>
</ul>
<h3 id="extended-backus-naur-from">Extended Backus-Naur-From</h3>
<ul>
<li>Originally developped by Nikolaus Wirth
<ul>
<li>Definition language</li>
<li>Standardized</li>
</ul>
</li>
<li>EBNF</li>
</ul>
<h4 id="data-definition">Data definition</h4>
<h5 id="schema-management">Schema management</h5>
<p>Create<br>
<code>CREATE SCHEMA &lt;Schema-Name&gt;</code><br>
Delete<br>
<code>DROP SCHEMA &lt;Schema-Name&gt; [CASCADE | RESTRICT]</code></p>
<h5 id="tables">Tables</h5>
<p>Create</p>
<pre><code>CREATE TABLE [Schema-name.]&lt;Table-Name&gt;
(
&lt;Attribute-Defintion&gt;,
[&lt;Table-Integrity-Constraints&gt;]
)
</code></pre>
<p>Attribute definition<br>
<code>&lt;Attribute-Definition&gt; ::= &lt;Attribute-Name&gt; TYPE &lt;Type-Definition&gt;</code></p>
<h5 id="data-types">Data types</h5>
<ul>
<li>INT</li>
<li>SMALLINT</li>
<li>BIGINT</li>
<li>DEC/NUM (p [,q]) - Fractional number (p digits, out of which q are fractional digits)</li>
<li>FLOAT</li>
<li>REAL (DOUBLE)</li>
<li>CHAR(n) - Character string of length N</li>
<li>VARCHAR(n) - <em>Variable-length</em> CHAR</li>
<li>NVARCHAR(n) - NVARCHAR with <em>Unicode</em></li>
<li>CLOB - Character Large Object, stores long texts</li>
<li>BLOB - Binary Large Object, stores large binary data (eg. Images)</li>
<li>BOOLEAN</li>
<li>DATE</li>
<li>TIME</li>
<li>TIMESTAMP</li>
</ul>
<h5 id="integrity-constraints">Integrity constraints</h5>
<ul>
<li><code>UNIQUE</code></li>
<li><code>NOT NULL</code></li>
<li><code>DEFAULT</code></li>
<li><code>CHECK (&lt;Condition&gt;)</code></li>
<li><code>PRIMARY KEY</code></li>
<li><code>REFERENCES &lt;Table-Name&gt; [&lt;Attribute-Name&gt;]</code></li>
<li><code>[ON DELETE CASCADE | SET NULL | SET DEFAULT | RESTRICT | NO ACTION]</code></li>
</ul>
<h5 id="foreign-keys-and-referential-integrity">Foreign keys and referential integrity</h5>
<ul>
<li>A foreign key in one table <em>always</em> points to a foreign key in another table</li>
</ul>
<h5 id="modification-of-tables">Modification of tables</h5>
<p><code>ALTER TABLE [&lt;Schema-Name&gt;.]&lt;Table-Name&gt; DROP [COLUMN] &lt;Attribute-Name&gt; [CASCADE | RESTRICT]</code></p>
<h5 id="views-and-indexes">Views and Indexes</h5>
<p>Saved select statement<br>
<code>CREATE VIEW &lt;View-Name&gt; [&lt;List-Of-Options&gt;] &lt;Select-Statement&gt;</code></p>
<h5 id="table-constraints">Table constraints</h5>
<p><code>CREATE TABLE &lt;Table-Name&gt; (&lt;field&gt; SMALL INT PRIMARY KEY CHECK(&lt;field&gt; between 0 and 100))</code></p>
<h5 id="foreign-keys">Foreign keys</h5>
<p><code>CREATE TABLE &lt;Table-Name&gt; (ID INT PRIMARY KEY, &lt;field&gt; INT REFERENCES &lt;Other-Table&gt;(&lt;field&gt;))</code></p>
<h5 id="complex-primary-keys">Complex Primary Keys</h5>
<p><code>CREATE TABLE &lt;Table-Name&gt; (customer_number INT, company_code INT, PRIMARY KEY(customer_number, company_code))</code></p>
<h4 id="indexes">Indexes</h4>
<p><code>CREATE [Unique] INDEX &lt;Name&gt; ON &lt;Table&gt; (&lt;Attribute-Name&gt; [ASC-DESC])</code></p>
<h4 id="joining-tables">Joining tables</h4>
<p><code>SELECT &lt;Table1&gt;.&lt;field&gt; &lt;Table2&gt;.&lt;field&gt; FROM &lt;Table1&gt; INNER JOIN &lt;Table2&gt;</code></p>
<h4 id="native-sql-functions">Native SQL functions</h4>
<p><code>IN</code> statement: Selects from a list, returns true if a is found in list b</p>
<p><code>AS</code> Keyword renames columns</p>
<p><code>DISTINCT</code> Keyword ensures records are shown only once</p>
<h5 id="calculations">Calculations</h5>
<p><code>SELECT price*1.1 FROM t_products</code></p>
<h5 id="aggregate-functions">Aggregate functions</h5>
<p><code>sum()</code></p>
<h5 id="like-expression">LIKE expression</h5>
<p><code>SELECT City FROM Customer WHERE City LIKE%heim</code></p>
<h4 id="grouping-results">Grouping results</h4>
<h5 id="group-by-clause">GROUP BY clause</h5>
<p><code>SELECT ArticleNumber, SUM(Amount) FROM Articles GROUP BY Region</code></p>
<h5 id="having-clause">HAVING clause</h5>
<p>Filters grouped entries</p>
<h3 id="indexes-1">Indexes</h3>
<blockquote>
<p><strong>Indexes</strong> are sets of pointers that point to the rows in a database table, in order to optimize access to them. They are based on attributes of the table.</p>
</blockquote>
<h3 id="trees">TREES</h3>
<ul>
<li>Binary tree (fan out = 2)</li>
<li>B-Tree (fo = n, balanced)</li>
<li>B±Tree (B-Tree but data is only on Leaf nodes)</li>
<li>B*-Tree (Nodes always filled at 2/3)</li>
</ul>
<h3 id="stored-procedures-and-functions">Stored procedures and functions</h3>
<ul>
<li>Procedures can be stored in a database</li>
<li>Single point definition of business logic</li>
<li>Can be SQL or other languages</li>
<li>Procedures do not return a value, access persistent data</li>
<li>Functions have a return value</li>
</ul>
<p><code>CREATE PROCEDURE &lt;name&gt; (IN/OUT/INOUT &lt;varname&gt;) DEFINER (NOT) DETERMINISTIC CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA SQL SECURITY BEGIN &lt;code&gt; END</code></p>
<h3 id="triggers">TRIGGERS</h3>
<blockquote>
<p><strong>Triggers</strong> are procedures that can be attached to a certain <em>event</em> in the database. For example if a user is deleted, a procedure runs that deletes all their files.</p>
</blockquote>
<p><code>CREATE TRIGGER &lt;name&gt; BEFORE INSERT OR UPDATE OF &lt;column&gt; FOR EACH ROW WHEN &lt;check_constraint&gt; &lt;code&gt;</code></p>
<p>Advantages:</p>
<ul>
<li>Performance
<ul>
<li>Save network roundtrips -&gt; low latency</li>
</ul>
</li>
<li>Portability and reuse</li>
<li>Security</li>
<li>Maintenance</li>
<li>Only DBMS required</li>
</ul>
<p>Disadvantages</p>
<ul>
<li>Overhead</li>
<li>Increases database server computing power</li>
<li>No clear separation between data and application logic</li>
<li>Code possibly needs to be maintained in multiple locations</li>
<li>CI?</li>
<li>Development</li>
</ul>
<h3 id="administration">Administration</h3>
<h4 id="mandatory-access-control">Mandatory Access Control</h4>
<p>Access control</p>
<blockquote>
<p><strong>Permissions</strong> are rights given to a certain user to access certain resources</p>
</blockquote>
<p>&nbsp;</p>
<blockquote>
<p><strong>Roles</strong> are sets of permissions</p>
</blockquote>
<p>&nbsp;</p>
<blockquote>
<p><strong>Groups</strong> are sets of users</p>
</blockquote>
<h4 id="transactions">Transactions</h4>
<blockquote>
<p><strong>Transactions</strong> are ways of ensuring a consistent state in the database, by only writing data if it is complete, and rolling it back otherwise</p>
</blockquote>
<p><code>START TRANSACTION (WITH CONSISTENT SNAPSHOT |READ WRITE | READ ONLY) BEGIN (WORK) (COMMIT (WORK) | ROLLBACK) autocomit (0|1)</code></p>
<h4 id="isolation-problems">Isolation problems</h4>
<ul>
<li>Dirty read</li>
<li>Non-repeatable read</li>
<li>Phantom read</li>
</ul>
<p>Solutions</p>
<ul>
<li>Serializeable</li>
<li>Read committed</li>
<li>Read uncommitted</li>
</ul>
<h4 id="two-phase-commit-2pc">Two-Phase Commit (2PC)</h4>
<ul>
<li>Ensure serialized transaction by granting/revoking locks</li>
<li>Phases
<ul>
<li>Growing phase -&gt; Obtains locks</li>
<li>Shrinking phase -&gt; Releases locks</li>
</ul>
</li>
</ul>
<h4 id="handling-failures-and-crashes">Handling failures and crashes</h4>
<ul>
<li>Logical error</li>
<li>System error
<ul>
<li>System crash</li>
<li>Disk failure</li>
</ul>
</li>
</ul>
<h3 id="administration-1">Administration</h3>
<p>root access -&gt; Generally a bad idea<br>
Audits<br>
Backups<br>
ACLs</p>
<h3 id="performance-tuning">Performance Tuning</h3>
<h4 id="data-dictionary">Data dictionary</h4>
<h5 id="information-schema">Information Schema</h5>
<p>Information about the database<br>
Formatted to make information more accessible</p>
<h5 id="performance-schema">Performance schema</h5>
<p>Contains information about performance of the database</p>
<h4 id="user-and-permission-management">User and permission management</h4>
<h5 id="based-on-grantrevoke-dac-system">Based on GRANT/REVOKE DAC system</h5>
<p>Users - User itself <code>CREATE USER &lt;username&gt;</code><br>
Privileges - What the user can do <code>GRANT &lt;username&gt; &lt;privileges&gt; ON &lt;tables&gt;</code><br>
Resource limits - How many system resources the user can access<br>
Password - Set password for user <code>{CREATE | ALTER} USER &lt;username&gt; IDENTIFIED BY &lt;password&gt;</code></p>
<h4 id="backup-and-restore">Backup and Restore</h4>
<ol>
<li>Backup Availability
<ul>
<li>3-2-1 rule</li>
</ul>
</li>
<li>Backup Scope
<ul>
<li>Full</li>
<li>Incremental</li>
<li>Differential</li>
</ul>
</li>
<li>Backup Frequency
<ul>
<li>Father / Grandfather schemes
<ul>
<li>6 daily backups</li>
<li>3 weekly backups</li>
<li>11 monthly backups</li>
<li>1 annual backup</li>
</ul>
</li>
<li>Towers of Hanoi scheme</li>
</ul>
</li>
<li>Backup targets
<ul>
<li>Different media</li>
</ul>
</li>
</ol>
<p>Reasons for having Backups</p>
<ul>
<li>Safety</li>
<li>Legal Requirements (SOx, Basel-II)</li>
<li>Compliance</li>
</ul>
<p>Restore test</p>
<h4 id="mysql-backup-tools">MySQL Backup tools</h4>
<ul>
<li>Cold backup
<ul>
<li>Offline, physical</li>
<li>Simple copy</li>
</ul>
</li>
<li>Warm backup
<ul>
<li>Locking logical</li>
<li>mysqldump</li>
</ul>
</li>
<li>Standby Copy
<ul>
<li>Hot-swappable</li>
<li>MySQL replication</li>
</ul>
</li>
<li>Hot backup
<ul>
<li>Online, Physical</li>
<li>mysqlbackup</li>
</ul>
</li>
</ul>
<h4 id="monitoring-requirements">Monitoring requirements</h4>
<ul>
<li>Availability</li>
<li>Historical reporting</li>
</ul>
<h5 id="mysql-enterprise-monitor">MySQL Enterprise Monitor</h5>
<ul>
<li>
<p>Distributed monitoring system</p>
<ul>
<li>Service management</li>
<li>Agents distributed across monitored hosts</li>
</ul>
</li>
<li>
<p>Client-side plugins for query analysis</p>
</li>
<li>
<p>Advisors</p>
</li>
<li>
<p>Events</p>
</li>
<li>
<p>Notification Groups</p>
</li>
<li>
<p>Graphs</p>
</li>
</ul>
<h4 id="replication">Replication</h4>
<ul>
<li>Two databases with the same data</li>
<li>Formats
<ul>
<li>Statement-based replication (each statement that is executed is transferred to the other database)</li>
<li>Raw-based replication (transfer result of the statement)</li>
<li>Mixed (utilize both systems)</li>
</ul>
</li>
<li>Methods
<ul>
<li>Binlog (Binary Transaction Log)</li>
<li>Replication using GTIDs
<ul>
<li>Identify each transaction, and supervise that everything runs correctly</li>
</ul>
</li>
</ul>
</li>
<li>Topologies
<ul>
<li>Master/Slave topology</li>
</ul>
</li>
</ul>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-yzJwT3KdpstPNEuh" height="100%" viewBox="0 0 175.20001220703125 106.71665954589844" style="max-width:175.20001220703125px;"><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M54.850006103515625,43.35832977294922L79.85000610351562,43.35832977294922L104.85000610351562,43.35832977294922" marker-end="url(#arrowhead47)" style="fill:none"></path><defs><marker id="arrowhead47" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node" style="opacity: 1;" id="A" transform="translate(37.42500305175781,43.35832977294922)"><rect rx="5" ry="5" x="-17.425003051757812" y="-23.35832977294922" width="34.850006103515625" height="46.71665954589844"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-7.4250030517578125,-13.358329772949219)"><foreignObject width="14.850006103515625" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">M</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="B" transform="translate(120.02500915527344,43.35832977294922)"><rect rx="5" ry="5" x="-15.175003051757812" y="-23.35832977294922" width="30.350006103515625" height="46.71665954589844"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.1750030517578125,-13.358329772949219)"><foreignObject width="10.350006103515625" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">B</div></foreignObject></g></g></g></g></g></g></svg></div>
<ul>
<li>Chained tolpology</li>
</ul>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-XCt6ClXqeljNqH3K" height="100%" viewBox="0 0 249.683349609375 106.71665954589844" style="max-width:249.683349609375px;"><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M54.850006103515625,43.35832977294922L79.85000610351562,43.35832977294922L104.85000610351562,43.35832977294922" marker-end="url(#arrowhead59)" style="fill:none"></path><defs><marker id="arrowhead59" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M129.33334350585938,43.35832977294922L154.33334350585938,43.35832977294922L179.33334350585938,43.35832977294922" marker-end="url(#arrowhead60)" style="fill:none"></path><defs><marker id="arrowhead60" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node" style="opacity: 1;" id="A" transform="translate(37.42500305175781,43.35832977294922)"><rect rx="5" ry="5" x="-17.425003051757812" y="-23.35832977294922" width="34.850006103515625" height="46.71665954589844"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-7.4250030517578125,-13.358329772949219)"><foreignObject width="14.850006103515625" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">M</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="B" transform="translate(117.0916748046875,43.35832977294922)"><rect rx="5" ry="5" x="-12.241668701171875" y="-23.35832977294922" width="24.48333740234375" height="46.71665954589844"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-2.241668701171875,-13.358329772949219)"><foreignObject width="4.48333740234375" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">I</div></foreignObject></g></g></g><g class="node" style="opacity: 1;" id="C" transform="translate(194.5083465576172,43.35832977294922)"><rect rx="5" ry="5" x="-15.175003051757812" y="-23.35832977294922" width="30.350006103515625" height="46.71665954589844"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.1750030517578125,-13.358329772949219)"><foreignObject width="10.350006103515625" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">B</div></foreignObject></g></g></g></g></g></g></svg></div>
<ul>
<li>Group replication
<ul>
<li>Bidirectional replication</li>
</ul>
</li>
</ul>
<h3 id="performance-tuning-1">Performance tuning</h3>
<blockquote>
<p><strong>Performance tuning</strong> is the act of optimizing the performance of a database without altering its functionality.</p>
</blockquote>
<ul>
<li>Performance tuning is <em>system-specific</em>.</li>
<li>Tuning is done by identifying and alleviating bottlenecks
<ul>
<li>Bottlenecks are points of the processing pipeline that cause the whole transaction to slow down</li>
<li>Pareto <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.36687em;"></span><span class="strut bottom" style="height: 0.36687em; vertical-align: 0em;"></span><span class="base"><span class="mrel">→</span></span></span></span></span> 80% of estates belong to 20% of owners</li>
<li>80% of all the CPU time is taken up by 20% of the code</li>
<li>Alleviating bottlenecks is done by making the metaphorical bottleneck wider</li>
<li>Database systems can be modeled as <em>queuing systems</em>, where each system has a queue</li>
</ul>
</li>
<li>Levels
<ol>
<li>Hardware level
<ul>
<li>More hardware ~= better performance</li>
<li>Monitoring hardware resources
<ul>
<li>Disk usage / I/O Operations</li>
<li>Buffer fill rate</li>
<li>CPU utilization</li>
<li>Incoming / Outgoing network packets</li>
<li>Latency</li>
</ul>
</li>
<li><strong>Five-minute rule</strong>
<ul>
<li>If a page that is randomly accessed is accessed more than once every 5 minutes, it’s more useful to keep it in memory.</li>
</ul>
</li>
<li><strong>One-minute rule</strong>
<ul>
<li>If a piece of data that is accessed more than once every minute, it should be kept in memory</li>
</ul>
</li>
<li>Disk redundancies
<ul>
<li>RAID systems</li>
</ul>
</li>
</ul>
</li>
<li>DB Parameters level
<ul>
<li>Tweaking system parameters</li>
<li>Change configuration files</li>
<li>Systems may have automatic tuning</li>
</ul>
</li>
<li>High-level DB design
<ul>
<li>Schema tuning
<ul>
<li>Denormalization
<ul>
<li>Add redundancies to tables to avoid constant table joining
<ul>
<li>Less resource usage when reading, more resource usage when writing</li>
</ul>
</li>
<li>Cluster frequently merged tables</li>
<li>Vertically partition relations</li>
</ul>
</li>
</ul>
</li>
<li>Changing indexing
<ul>
<li>Create appropriate indices to speed up slow queries</li>
<li>Remove unneeded indices</li>
<li>Change index type</li>
<li>Clustered index</li>
</ul>
</li>
<li>Using materialized views
<ul>
<li><strong>Materialized views</strong> store the view as an additional table</li>
<li>This makes queries faster</li>
<li>Overhead from keeping the view up-to-date</li>
<li>Disk space overhead</li>
</ul>
</li>
<li>Tuning transactions
<ul>
<li>Keep transactions short</li>
<li>Avoid deadlocks</li>
<li>Use stored procedures</li>
<li>Combine multiple queries into a single query</li>
<li>Mini-batch transaction</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li>Performance benchmarks
<ul>
<li>Throughput</li>
<li>Response time</li>
<li>Availability</li>
</ul>
</li>
</ul>
<p>Nicolai Andler: Methods and tools for project management workshops and consulting</p>
<h2 id="centralized-systems">Centralized systems</h2>
<blockquote>
<p>For a more detailed explanation, please refer to the operating systems notes</p>
</blockquote>
<ul>
<li>Von Neumann Architecture (&lt;-&gt; Harward Architecture)</li>
<li>Client-Server systems
<ul>
<li>Back-end – Manages data</li>
<li>Front-end – Tools and GUI facilities</li>
</ul>
</li>
</ul>
<h3 id="transaction-server-processes">Transaction Server processes</h3>
<ul>
<li>Server process
<ul>
<li>Receive user queries</li>
<li>Usually multithreaded</li>
<li>Multiple processes</li>
</ul>
</li>
<li>Lock management process</li>
<li>Database writer process
<ul>
<li>Output modified buffer blocks to disks continually</li>
</ul>
</li>
<li>Log writer
<ul>
<li>Writes the transaction lock continually to disk</li>
</ul>
</li>
<li>Checkpoint process
<ul>
<li>Performs periodic checkups</li>
</ul>
</li>
<li>Process monitor process
<ul>
<li>Monitors other processes</li>
</ul>
</li>
</ul>
<h3 id="data-servers">Data servers</h3>
<ul>
<li>High-speed LAN</li>
<li>Data is shipped to the client for processing and then shipped back when it’s done</li>
<li>Object-oriented DBs</li>
<li>Page-shipping vs Item-shipping
<ul>
<li>Shipping – Delivering data</li>
<li>Prefetching pages?</li>
<li>Smaller units – More messages</li>
</ul>
</li>
<li>Locking
<ul>
<li>Overhead of getting locks is high</li>
<li>Grants locks on prefetched items</li>
<li>Locks on prefetched items can be called back by the server</li>
<li>Locks on page can be de-escalated to items on the page</li>
</ul>
</li>
<li>Data caching
<ul>
<li>Cached on client between transactions</li>
<li>Cache-choherency – Check if cache is up-to-date</li>
<li>Check done when requesting lock</li>
</ul>
</li>
<li>Lock caching
<ul>
<li>Server administers everything</li>
</ul>
</li>
</ul>
<h3 id="parallel-systems">Parallel systems</h3>
<ul>
<li>Parallel database systems consist of multiple processors, disks connected over the network</li>
<li>A <strong>Coarse-grain machine</strong> has a few powerful processors</li>
<li>A <strong>Fine-grain</strong> or <strong>massively parallel</strong> machine utilizes thousands of small processing units</li>
<li>Performance metrics
<ul>
<li>Throughput</li>
<li>Response</li>
</ul>
</li>
<li>Speedup
<ul>
<li>Task runs faster on a bigger machine</li>
<li>Scales linearly with machine size -&gt; good</li>
</ul>
</li>
<li>Scaleup
<ul>
<li>Bigger task runs in the same time on a larger system</li>
<li>Time required stays the same  -&gt; good</li>
</ul>
</li>
<li>Batch and Transactional scaleup
<ul>
<li>Batch scaleup</li>
<li>Transaction scaleup
<ul>
<li>Numerous small queries submitted independently by many users</li>
<li>TPSs, time-sharing systems</li>
</ul>
</li>
<li>Limiting factors
<ul>
<li>Startup cost
<ul>
<li>Parallelism need set-up time</li>
</ul>
</li>
<li>Interference
<ul>
<li>Synchronizing resources</li>
</ul>
</li>
<li>Skew
<ul>
<li>Increasing degree of parallelism increases the variance in service times. Overall time is determined by the <em>slowest</em> service</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="interconnecting-network-architectures">Interconnecting network architectures</h3>
<ul>
<li>Bus
<ul>
<li>Simple linear connection between systems</li>
<li>Simple, but does not scale well</li>
</ul>
</li>
<li>Mesh
<ul>
<li>Components arranged in a grid, each component connected to adjacent components</li>
<li>Lower number of connections</li>
</ul>
</li>
<li>Hypercube
<ul>
<li>Same as grid, but more adjacent nodes</li>
<li>More redundancy</li>
</ul>
</li>
</ul>
<h3 id="parallel-db-architectures">Parallel DB architectures</h3>
<ul>
<li>Shared memory
<ul>
<li>Efficient communication between processors</li>
<li>Von-Neumann bottleneck – Bus system unable to handle more than 32 or 64 processors</li>
</ul>
</li>
<li>Shared disk
<ul>
<li>All CPUs can access disks</li>
<li>Fault-tolerance – If a processor fails the others can take over</li>
<li>Overhead occurs in the interconnection to the disk subsystem</li>
<li>Connection between processors is slower</li>
</ul>
</li>
<li>Nothing shared
<ul>
<li>Node consists of CPU, Memory, Disk</li>
<li>Scales well to lots of processors</li>
<li>High overhead</li>
</ul>
</li>
<li>Hierarchical – Hybrid of all the above</li>
</ul>
<h3 id="distributed-dbs">Distributed DBs</h3>
<ul>
<li>Homogenious distributed systems
<ul>
<li>Same software and setup on all sites</li>
</ul>
</li>
<li>Heterogenious distributed systems
<ul>
<li>Different functionality on each site</li>
<li>Integrate existing DBs</li>
</ul>
</li>
<li>Local vs global transactions
<ul>
<li>Local transactions access data from a single site</li>
<li>Global transactions access data from multiple sites – two-phase commit</li>
</ul>
</li>
</ul>
<h3 id="pros-and-cons">Pros and cons</h3>
<ul>
<li>Sharing data</li>
<li>Autonomy</li>
<li>High availability</li>
<li>Complexits</li>
</ul>
<h3 id="possible-implementation-difficulties">Possible implementation difficulties</h3>
<ul>
<li>Atomicity through 2PC</li>
<li>Sometimes other systems also used</li>
<li>Distributed concurrency control</li>
<li>Data items replicated</li>
</ul>
<h3 id="network-types">Network types</h3>
<ul>
<li>LAN
<ul>
<li>NAS</li>
<li>SAN</li>
</ul>
</li>
<li>WAN
<ul>
<li>WAN (i.e. the internet) to distribute large systems</li>
<li>Groupware (lotus notes)</li>
</ul>
</li>
</ul>
<h3 id="replication-1">Replication</h3>
<ul>
<li>The data is copied to multiple sites</li>
<li>Advantages
<ul>
<li>Availability</li>
<li>Parallelism</li>
<li>Reduced data transfer</li>
</ul>
</li>
<li>Disadvantages
<ul>
<li>Increased cost of updates</li>
<li>Increased complexity of concurrency control</li>
</ul>
</li>
</ul>
<h3 id="fragmentation">Fragmentation</h3>
<ul>
<li>Data is split among multiple sites</li>
<li>Horizontal fragmentation (homogeneous)</li>
<li>Vertical fragmentation (heterogeneous)</li>
</ul>
<h3 id="naming-things-in-distributed-systems">Naming things in distributed systems</h3>
<ul>
<li>Every data item must have a system-wide unique name</li>
<li>Solutions
<ul>
<li>Name server gives names to all items - Single point of failure, performance bottleneck</li>
<li>Use of prefixes- new names for everything, non-network-transparent</li>
<li>Use aliases - stored on each site, make prefixed data network-transparent</li>
</ul>
</li>
</ul>
<h3 id="alternative-solutions-of-transaction-processing">Alternative solutions of transaction processing</h3>
<ul>
<li>Error conditions
<ul>
<li>Failure situations</li>
</ul>
</li>
<li>Persistent messaging workflows
<ul>
<li>Workflow = Structured way of sending a message</li>
</ul>
</li>
</ul>
<h3 id="distributed-lock-management">Distributed lock management</h3>
<ul>
<li>All sites have lock managers</li>
<li>Work is distributed, more robust to failures</li>
<li>Deadlock detection is more complicated</li>
<li>Variants
<ul>
<li>Primary copy -&gt; Master-slave model</li>
<li>Majority copy -&gt; If more than 50% of the sites approve the lock, the resource is considered locked</li>
<li>Biased protocol
<ul>
<li>Makes reading easier</li>
<li>Shared locks are easier to acquire</li>
<li>Exclusive locks need all sites</li>
</ul>
</li>
<li>Quorum consensus
<ul>
<li>Read- and Write locks have a certain weight</li>
<li>Certain requests can have different weights (weights determine how many nodes are needed for lock)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="availability">Availability</h3>
<ul>
<li>Robustness
<ul>
<li>Detect failures</li>
<li>Reconfigure the system so that computation may continue</li>
<li>Recovery</li>
</ul>
</li>
<li>Reconfiguration</li>
<li>Trading consistency for availability</li>
</ul>
<h3 id="consistency">Consistency</h3>
<ul>
<li>Consistency in DBs (ACID)
<ul>
<li>Database integrity standards</li>
</ul>
</li>
<li>Strong consistency
<ul>
<li>All behaves like a local system</li>
</ul>
</li>
<li>Weak consistency</li>
<li>BASE (Basically Available, Soft-state, Eventual consistency)</li>
</ul>
<h3 id="ldap-lightweight-directory-access-protocol">LDAP (Lightweight Directory Access Protocol)</h3>
<ul>
<li>LDAP Model</li>
<li>Data Manipulation</li>
<li>Distributed directory trees</li>
<li>e.g. Microsoft Active Directory, RDNs</li>
</ul>
<h3 id="decision-support-systems">Decision support systems</h3>
<ul>
<li>Data warehouse
<ul>
<li>contains lotsa data</li>
<li>ETL (Extract, Transform, Load)</li>
</ul>
</li>
<li>Data mart
<ul>
<li>You can get individual data</li>
</ul>
</li>
<li>Data lake
<ul>
<li>Contains non-structured data</li>
</ul>
</li>
<li>Source driven architecture</li>
<li>Destination-driven architecture</li>
<li>Dimension values are encoded in small integers
<ul>
<li>Snowflake-schema</li>
<li>Star-schema</li>
</ul>
</li>
<li>Data mining
<ul>
<li>Prediction</li>
<li>Classification</li>
<li>Regression</li>
</ul>
</li>
<li>Decision trees</li>
<li>Construction of decision trees
<ul>
<li>Greedy approach</li>
<li>Gini measure</li>
<li>Information gain</li>
<li>Baysian classifiers</li>
</ul>
</li>
</ul>
<h2 id="possible-exam-questions">Possible exam questions</h2>
<ul>
<li>What three mySQL command line clients are there?
<ul>
<li>mysql</li>
<li>mysqladmin</li>
<li>mysqldump</li>
<li>mysqlpump</li>
</ul>
</li>
<li>What are the two most important internal administration schemata in mySQL
<ul>
<li>mysql</li>
<li>INFORMATION_SCHEMA</li>
<li>PERFORMANCE_SCHEMA</li>
</ul>
</li>
<li>Create a user called “joe” identified by the password “Heureka!” with access to the whole system
<ul>
<li>CREATE USER ‘joe’ IDENTIFIED BY ‘Heureka!’</li>
<li>GRANT ALL ON * to ‘joe’</li>
</ul>
</li>
<li>Describe the 3-2-1 backup rule</li>
<li>Explain what distinguishes full, incremental and differential backups</li>
<li>Which tool is employed to create a warm (logical) backup in mySQL, what are the disadvantages?</li>
<li>Name three tunable properties
<ul>
<li>Hardware</li>
<li>Transactions</li>
<li>Config parameters</li>
<li>Indices</li>
<li>Denormalization</li>
<li>Materiaized views</li>
</ul>
</li>
<li>Describe RAID 1 and 5</li>
<li>Which are the two performance benchmarks
<ul>
<li>Response time</li>
<li>Throughput</li>
</ul>
</li>
<li>Into which kind of systems can DB servers be categorized
<ul>
<li>Transactional servers
<ul>
<li>Troughput</li>
</ul>
</li>
<li>Decision support systems
<ul>
<li>Large systems, few transactions</li>
</ul>
</li>
</ul>
</li>
<li>Six common internal processes of a transaction database servers
<ul>
<li>Server process
<ul>
<li>Receive user queries</li>
<li>Usually multithreaded</li>
<li>Multiple processes</li>
</ul>
</li>
<li>Lock management process</li>
<li>Database writer process
<ul>
<li>Output modified buffer blocks to disks continually</li>
</ul>
</li>
<li>Log writer
<ul>
<li>Writes the transaction lock continually to disk</li>
</ul>
</li>
<li>Checkpoint process
<ul>
<li>Performs periodic checkups</li>
</ul>
</li>
<li>Process monitor process
<ul>
<li>Monitors other processes</li>
</ul>
</li>
</ul>
</li>
<li>What is a system scaleup</li>
<li>What factors are limiting the scaleup of a system</li>
<li>What is the difference between a homogeneous and a heterogeneous distributed database?</li>
<li>What’s the difference between a local and a global transaction?</li>
<li>Name at least two methods used for coordinating the execution of distributed transactions
<ul>
<li>2PC</li>
<li>Persistent messaging</li>
<li>Workflow</li>
</ul>
</li>
<li>Name the phases of a two-phase commit
<ul>
<li>Obtaining the decision</li>
<li>Recording the decision</li>
</ul>
</li>
<li>Define the term “Distributed database system”
<ul>
<li>Data spread across different sites</li>
<li>Requires distributed transactions</li>
<li>Can be heterogeneous or homogeneous</li>
</ul>
</li>
<li>Which methods are applied for storing data across distributed sites?
<ul>
<li>Vertical or Horizontal fragmentation</li>
<li>Replication</li>
</ul>
</li>
<li>Which agents can be used to control concurrency in distributed environments
<ul>
<li>Global single lock manager</li>
<li>Distributed lock manager</li>
</ul>
</li>
<li>Explain the CAP theorem
<ul>
<li>Consistency</li>
<li>Availability</li>
<li>Partition tolerance</li>
</ul>
</li>
<li>For distributed systems how is the relaxed form of the ACID requirements called?
<ul>
<li>BASE
<ul>
<li>Basically Available</li>
<li>Soft-state</li>
<li>Eventual consistency</li>
</ul>
</li>
</ul>
</li>
<li>Define “Decision support systems” and give some examples
<ul>
<li>Decision support systems are often based on data collected by on-line transaction processing systems
<ul>
<li>Data analysis</li>
<li>Statistical analysis</li>
<li>Data mining</li>
<li>Data warehouse</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</body>

</html>
